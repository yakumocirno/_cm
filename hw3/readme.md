#  [AI對話](https://chatgpt.com/share/69592395-5fd8-8005-9770-7c3012b464d6)
# 三次方程式求根（Cardano 方法）

## 問題說明

本程式實作一個 Python 函數 `root3(a, b, c, d)`，用來求解一般三次多項式：

[
ax^3 + bx^2 + cx + d = 0
]

目標是：

* 使用**解析解（Cardano 公式）**求出三個根
* 能正確處理**實數根與複數根**
* 將結果代回原多項式驗證正確性

---

## 解題思路總覽

三次方程式的解析解流程如下：

1. **正規化係數（令最高次係數為 1）**
2. **降階（消去二次項）**
3. **計算判別式**
4. **套用 Cardano 公式求解降階後的方程式**
5. **轉回原變數，得到三個根**

由於過程中會出現負數開根號與複數立方根，因此使用 `cmath` 模組來處理複數運算。

---

## 詳細解題步驟

### 1️⃣ 正規化三次方程式

原方程式：
[
ax^3 + bx^2 + cx + d = 0
]

先除以 ( a )（假設 ( a \neq 0 )），得到：
[
x^3 + Ax^2 + Bx + C = 0
]

其中：
[
A = \frac{b}{a}, \quad B = \frac{c}{a}, \quad C = \frac{d}{a}
]

---

### 2️⃣ 降階（消去二次項）

令變數變換：
[
x = y - \frac{A}{3}
]

代入後，可將原方程式轉換為**降階三次方程式**：
[
y^3 + py + q = 0
]

其中：
[
p = B - \frac{A^2}{3}
]
[
q = \frac{2A^3}{27} - \frac{AB}{3} + C
]

這一步的目的是簡化方程式，讓後續解法更直接。

---

### 3️⃣ 判別式

對於降階後的三次方程式 ( y^3 + py + q = 0 )，其判別式定義為：

[
\Delta = \left( \frac{q}{2} \right)^2 + \left( \frac{p}{3} \right)^3
]

判別式決定根的型態（實根或複根），但在本程式中不需要特別分情況，因為 `cmath` 可以統一處理。

---

### 4️⃣ Cardano 公式

定義：
[
u = \sqrt[3]{-\frac{q}{2} + \sqrt{\Delta}}, \quad v = \sqrt[3]{-\frac{q}{2} - \sqrt{\Delta}}
]

則降階後方程式的三個解為：

[
y_1 = u + v
]
[
y_2 = \omega u + \omega^2 v
]
[
y_3 = \omega^2 u + \omega v
]

其中 ( \omega ) 為**複數立方單位根**：
[
\omega = -\frac{1}{2} + \frac{\sqrt{3}}{2}i
]

---

### 5️⃣ 轉回原變數

最後利用：
[
x = y - \frac{A}{3}
]

將 ( y_1, y_2, y_3 ) 轉換回原方程式的三個根 ( x_1, x_2, x_3 )。

---

## 程式結構說明

### `root3(a, b, c, d)`

* **輸入**：三次多項式係數
* **輸出**：一個 tuple `(x1, x2, x3)`，代表三個根（可能為複數）
* 若 `a = 0`，直接拋出錯誤，避免誤用

### `f(x, a, b, c, d)`

* 計算多項式值 ( ax^3 + bx^2 + cx + d )
* 用於驗證求得的根是否正確

---

## 測試案例

測試方程式：
[
x^3 + 1 = 0
]

對應係數：

```python
a = 1
b = 0
c = 0
d = 1
```

此方程式理論上有三個根：

* ( x = -1 )
* 以及兩個共軛複數根

程式輸出每個根並代回原式，結果接近 0，表示解法正確。

---

## 結論

本程式完整實作了三次方程式的 **Cardano 解析解法**，並透過 `cmath` 模組：

* 正確處理複數開根號與立方根
* 不需額外區分判別式情況
* 能同時求得三個根並加以驗證

這對理解高次多項式的解析結構與複數運算具有良好的學習價值。
